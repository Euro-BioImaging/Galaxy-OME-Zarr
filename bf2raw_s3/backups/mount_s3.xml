<tool id="mount_s3" name="mount_s3" version="1.0.0">
    <requirements>
        <requirement type="package" version = "1.59.2" >rclone</requirement>
    </requirements>
    <command><![CDATA[

if [ ! -d '$output.extra_files_path' ];then
    mkdir '$output.extra_files_path';
fi;

if [ ! -d '$output.extra_files_path'/$mountpoint ];then    ### WARNING Is this line correct?!!!
    mkdir -p '$output.extra_files_path'/$mountpoint;
fi;


if [ ! -d '$output.extra_files_path'/nextpath ];then    ### WARNING Is this line correct?!!!
    mkdir -p '$output.extra_files_path'/nextpath;
fi;



bash $create_config;
rclone --config $output.extra_files_path/.rclone.conf mount --daemon minio:$bucket_path '$output.extra_files_path'/$mountpoint;
cp '$output.extra_files_path'/$mountpoint/filo.tif '$output.extra_files_path'/nextpath;
fusermount -u '$output.extra_files_path'/$mountpoint;
python $__tool_directory__/complete_transfer2html.py -d $output;



##rm -r '$output.extra_files_path'/tempdir;

###python $__tool_directory__/utils/warn.py;
    ]]></command>
    <configfiles>
        <configfile name="create_config">
rclone config create minio $type \
provider=$provider \
access_key_id=$accesskey \
secret_access_key=$secretkey \
endpoint=$endpoint \
acl=private > $output.extra_files_path/.rclone.conf
        </configfile>
    </configfiles>
    <inputs>
        <param name="bucket_path" type="text" value="eosc-future" label=" path at the s3 bucket " />
        <param name="mountpoint" type="text" value="mountdir" label=" path at the Galaxy " />
        <param name="type" type="text" value="s3" label=" Type of the cloud " />
        <param name="provider" type="text" value="Minio" label=" Name of the provider " />
        <param name="accesskey" type="text" value="eosc-future-user" label=" access key id " />
        <param name="secretkey" type="text" value="w2xx9EatWwmtsrbewt3LEfiGB" label=" secret key id " />
        <param name="endpoint" type="text" value="s3.embl.de" label=" endpoint " />
    </inputs>
    <outputs>
        <data name="output" format="html" label="mountpoint" />
    </outputs>
</tool>





###cp $output.extra_files_path/$rclone_config.mountpoint/$io_options.input_filepath $output.extra_files_path/nextpath;
#python $__tool_directory__/main.py bioformats2raw '$output.extra_files_path/$rclone_config.mountpoint/$io_options.input_filepath' '$output.extra_files_path/$rclone_config.mountpoint/$io_options.output_filepath'
#--series $bf2raw_params.series
#--resolution $bf2raw_params.resolutions
#--tile_height $bf2raw_params.tile_height
#--tile_width $bf2raw_params.tile_width
#--chunk_depth $bf2raw_params.chunk_depth
#--downsample_type $bf2raw_params.downsample_type
#--compression $bf2raw_params.compression
#--max_workers $bf2raw_params.max_workers
#--nesting $bf2raw_params.nesting
#--omefolder $bf2raw_params.omefolder
#--droptop $bf2raw_params.droptop
#--dimension_order $bf2raw_params.dimension_order;
##--overwrite
##--debug off;